<!DOCTYPE html>
<html>

    <head>
        <script src="index.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
    </head>

    <body>

        <h1>Basic Function Demonstration</h1>

        <button type="button" onclick="generate()">Click to start</button>

        <script>
            function generate() {
                const doc = new Document();

                doc.Styles.createParagraphStyle("Heading1", "Heading 1")
                    .basedOn("Normal")
                    .next("Normal")
                    .quickFormat()
                    .size(36)
                    .bold()
                    // .italics()
                    .spacing({ after: 240 });

                const theTitle = prompt("Please enter the title of this important document:");
                const theClientName = prompt("Please enter the name of the client:");
                const theFirmName = prompt("Please enter the name of your firm:");
                const theAttyName = prompt("Please enter the attorney's name:");

                doc.createParagraph(theTitle).heading1().center();
                const paragraph = new Paragraph("On this, the sixth day of July, 2019, ");
                const clientNameTextRun = new TextRun(theClientName).bold();
                const restOfTheParagraph = new TextRun(" did appear before me at the law firm of " + theFirmName + ".")
                paragraph.addRun(clientNameTextRun);
                paragraph.addRun(restOfTheParagraph);
                doc.addParagraph(paragraph);



                // doc.createParagraph("On this, the sixth day of July, 2019, " + new TextRun(theClientName).bold() + " did appear before me at the law firm of "+ theFirmName + ".");
                doc.createParagraph("");
                doc.createParagraph("Signed: " + theAttyName);

                doc.Header.createParagraph(new Date().toLocaleDateString()).center();
                doc.Footer.createParagraph("Page number " + Math.floor(Math.random() * 10) + 1).right();





                // const nameBold = new Paragraph(new TextRun(prompt("Please enter your name:")).bold());
                // const address = new Paragraph(new TextRun(prompt("Please enter your address:")));
                // const cityStateZip = new Paragraph(new TextRun(prompt("Please enter your city, state, and zip code:")));
                // doc.addParagraph(nameBold);
                // doc.addParagraph(address);
                // doc.addParagraph(cityStateZip);

                const packer = new Packer();

                packer.toBlob(doc).then(blob => {
                    console.log(blob);
                    saveAs(blob, "example.docx");
                    console.log("Document created successfully");
                });

                var theData = `theTitle:\t${theTitle}
theClientName:\t${theClientName}
theFirmName:\t${theFirmName}
theAttyName:\t${theAttyName}`;
                var blob = new Blob([ theData ], {
                    type: "text/plain;charset=utf-8"
                });
                // var theData = [];
                // theData.push("theTitle:\t" + theTitle);
                // var blob = new Blob([ theData.toString() ], {
                //     type: "text/plain;charset=utf-8"
                // });
                var url = URL.createObjectURL(blob);

                var a = document.createElement('a');
                a.download = "data.txt";
                a.href = url;
                a.click();

            }
        </script>

    </body>

</html>